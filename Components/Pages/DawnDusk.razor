@using WeatherStation
@inject IHttpClientFactory _clientFactory

<article class="dd">
    <section class="marginless">
        <h3 class="hidden">Soluppgång</h3>
        <div class="weather-icons">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="qi-100-fill"
                viewBox="0 0 16 16">
                <path
                    d="M8.005 3.5a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Zm.004-.997a.5.5 0 0 1-.5-.5v-1.5a.5.5 0 0 1 1 0v1.5a.5.5 0 0 1-.5.5ZM3.766 4.255a.498.498 0 0 1-.353-.147l-1.062-1.06a.5.5 0 0 1 .707-.707L4.122 3.4a.5.5 0 0 1-.355.854v.001ZM2.004 8.493h-1.5a.5.5 0 1 1 0-1h1.5a.5.5 0 1 1 0 1Zm.691 5.303a.5.5 0 0 1-.354-.854l1.062-1.06a.5.5 0 0 1 .708.707l-1.063 1.06a.497.497 0 0 1-.353.147Zm5.301 2.201a.5.5 0 0 1-.5-.5v-1.5a.5.5 0 0 1 1 0v1.5a.5.5 0 0 1-.5.5Zm5.304-2.191a.496.496 0 0 1-.353-.147l-1.06-1.06a.5.5 0 1 1 .706-.707l1.06 1.06a.5.5 0 0 1-.353.854Zm2.203-5.299h-1.5a.5.5 0 0 1 0-1h1.5a.5.5 0 1 1 0 1ZM12.25 4.265a.5.5 0 0 1-.354-.854l1.06-1.06a.5.5 0 1 1 .708.707l-1.06 1.06a.498.498 0 0 1-.354.147Z" />
            </svg>
        </div>
        <p class="numbers">@dawnDuskVGotaland?.Results?.Sunrise</p>
    </section>
    <section class="marginless">
        <h3 class="hidden">Solnedgång</h3>
        <div class="weather-icons">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="qi-150-fill"
                viewBox="0 0 16 16">
                <path
                    d="M4.733.059c.46-.226.925.238.811.732C4.94 3.424 4.984 6.384 7 8.5c2.017 2.116 5.529 2.888 8.234 2.458.507-.08.948.405.69.844a8.432 8.432 0 0 1-1.547 1.919C10.94 16.9 5.54 16.733 2.313 13.347a8.323 8.323 0 0 1 .38-11.887A8.538 8.538 0 0 1 4.732.06Z" />
            </svg>
        </div>
        <p class="numbers">@dawnDuskVGotaland?.Results?.Sunset</p>
    </section>
</article>

@code {
    public RiseSetkEntry? dawnDuskVGotaland;
    string? errorMessage;
    protected override async Task OnInitializedAsync()
    {
        var request = new HttpRequestMessage(HttpMethod.Get,
        "https://api.sunrisesunset.io/json?lat=58.25279&lng=13.05964&time_format=24");

        var client = _clientFactory.CreateClient();

        HttpResponseMessage response = await client.SendAsync(request);

        if (response.IsSuccessStatusCode)
        {
            dawnDuskVGotaland = await response.Content.ReadFromJsonAsync<RiseSetkEntry>();
            errorMessage = null;
        }
        else
        {
            errorMessage = $"Error fetching data: {response.ReasonPhrase}";
        }
    }
}